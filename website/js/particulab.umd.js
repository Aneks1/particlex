(function(a,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(a=typeof globalThis<"u"?globalThis:a||self,s(a.particulab={}))})(this,function(a){"use strict";var H=Object.defineProperty;var z=(a,s,h)=>s in a?H(a,s,{enumerable:!0,configurable:!0,writable:!0,value:h}):a[s]=h;var e=(a,s,h)=>z(a,typeof s!="symbol"?s+"":s,h);class s{constructor(t,i,n,l){e(this,"red");e(this,"green");e(this,"blue");e(this,"alpha");if(this.red=t,this.green=i,this.blue=n,this.alpha=l,t>255||t<0||i>255||i<0||n>255||n<0||l>1||l<0)throw new TypeError("Invalid rgba color.")}toHex(){const t=this._componentToHex(this.red),i=this._componentToHex(this.green),n=this._componentToHex(this.blue);return new h(`#${t}${i}${n}`)}_componentToHex(t){const i=t.toString(16);return i.length===1?"0"+i:i}toString(){return`rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`}}class h{constructor(t){e(this,"hex");t[0]==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(i=>i+i).join("")),this.hex=t}toRGB(){const t=parseInt(this.hex.slice(0,2),16),i=parseInt(this.hex.slice(2,4),16),n=parseInt(this.hex.slice(4,6),16);return new s(t,i,n,1)}toString(){return`#${this.hex}`}}class c{constructor(t,i){e(this,"parent");e(this,"options");e(this,"deltaSize",0);e(this,"deltaOpacity",0);if(i.opacity==null&&i.scaleFactor==null)throw new TypeError("Can not create a FadeHandler with opacity and scaleFactor both undefined .");this.parent=t,this.options=i}}class f extends c{constructor(t,i){super(t,i),this.calculateDeltas()}calculateDeltas(){this.options.opacity!=null&&(this.deltaOpacity=(this.options.opacity-this.parent.opacity)/this.options.duration),this.options.scaleFactor!=null&&(this.deltaSize=(this.options.scaleFactor*this.parent.size-this.parent.size)/this.options.duration)}}class p extends c{constructor(i,n){super(i,n);e(this,"initialLife");this.calculateDeltas(),this.initialLife=this.parent.life}calculateDeltas(){this.options.opacity!=null&&(this.deltaOpacity=(this.parent.opacity-this.options.opacity)/this.options.duration),this.options.scaleFactor!=null&&(this.deltaSize=(this.parent.size-this.options.scaleFactor*this.parent.size)/this.options.duration)}}class u{constructor(t,i){e(this,"parent");e(this,"id");e(this,"position",{x:0,y:0});e(this,"size",0);e(this,"life",0);e(this,"speed",{x:0,y:0});e(this,"color",new h("#ffffff"));e(this,"opacity",100);e(this,"fadeOut");e(this,"fadeIn");e(this,"fadeOutHandler");e(this,"fadeInHandler");this.parent=i,this.id=t}init(){var i,n,l,m;this.fadeOut&&(this.fadeOut.opacity!=null||this.fadeOut.scaleFactor!=null)&&(this.fadeOutHandler=new f(this,this.fadeOut)),this.fadeIn&&(this.fadeIn.opacity!=null||this.fadeIn.scaleFactor!=null)&&(this.fadeInHandler=new p(this,this.fadeIn)),this.opacity=((i=this.fadeIn)==null?void 0:i.opacity)!=null?(n=this.fadeIn)==null?void 0:n.opacity:Math.max(0,Math.min(100,this.opacity)),this.size=((l=this.fadeIn)==null?void 0:l.scaleFactor)!=null?(m=this.fadeIn)==null?void 0:m.scaleFactor:Math.max(0,this.size),this.life=Math.max(0,this.life);const t=setInterval(()=>{var I,y,g;this.position.x+=this.speed.x*60/1e3,this.position.y-=this.speed.y*60/1e3,this.fadeIn&&this.fadeInHandler&&this.life>=this.fadeInHandler.initialLife-this.fadeIn.duration&&(this.opacity+=((I=this.fadeInHandler)==null?void 0:I.deltaOpacity)*(1/60),this.opacity=Math.max(0,Math.min(100,this.opacity)),this.size+=this.fadeInHandler.deltaSize*(1/60),this.size=Math.max(0,this.size)),this.fadeOut&&this.fadeOutHandler&&this.life<=((y=this.fadeOut)==null?void 0:y.duration)&&(this.opacity+=((g=this.fadeOutHandler)==null?void 0:g.deltaOpacity)*(1/60),this.opacity=Math.max(0,Math.min(100,this.opacity)),this.size+=this.fadeOutHandler.deltaSize*(1/60),this.size=Math.max(0,this.size)),this.life-=1/60,this.life<=0&&(clearInterval(t),this.parent.particles.delete(this.id))},this.parent.deltaTime)}}function r(d,t){return{min:d,max:t}}class o{constructor(t,i){e(this,"canvas");e(this,"canvasSize");e(this,"lastId",0);e(this,"deltaTime",1e3/60);e(this,"amount",0);e(this,"particles",new Map);e(this,"size",r(1,5));e(this,"life",r(10,15));e(this,"speed",{x:r(-10,10),y:r(-10,10)});e(this,"colors",[]);e(this,"opacity",r(50,100));e(this,"fadeOut");e(this,"fadeIn");this.canvas=t,this.canvasSize=i,t.width=i.x,t.height=i.y}static getRandomNumberInInterval(t){const i=Math.ceil(t.min),n=Math.floor(t.max);return Math.floor(Math.random()*(n-i+1))+i}static getRandomElementFromArray(t){const i=Math.floor(Math.random()*t.length);return t[i]}createParticle(){const t=new u(this.lastId.toString(),this);t.position.x=o.getRandomNumberInInterval({min:0,max:this.canvasSize.x}),t.position.y=o.getRandomNumberInInterval({min:0,max:this.canvasSize.y}),t.size=o.getRandomNumberInInterval(this.size),t.life=o.getRandomNumberInInterval(this.life),t.speed.x=o.getRandomNumberInInterval(this.speed.x),t.speed.y=o.getRandomNumberInInterval(this.speed.y),t.color=o.getRandomElementFromArray(this.colors||new h("fff")),t.opacity=o.getRandomNumberInInterval(this.opacity),t.fadeOut=this.fadeOut,t.fadeIn=this.fadeIn,t.init(),this.particles.set(this.lastId.toString(),t),this.lastId++}init(){const t=this.canvas.getContext("2d");for(let i=0;i<this.amount;i++)this.createParticle();setInterval(()=>{if(this.particles.size<this.amount)for(let i=this.particles.size;i<this.amount;i++)this.createParticle();t==null||t.clearRect(0,0,this.canvas.width,this.canvas.height),this.particles.forEach(i=>{t.fillStyle=i.color.toString(),t.globalAlpha=i.opacity/100,t==null||t.beginPath(),t==null||t.arc(i.position.x,i.position.y,i.size/2,0,2*Math.PI,!1),t==null||t.closePath(),t==null||t.fill()})},this.deltaTime)}}a.FadeHandler=c,a.FadeInHandler=p,a.FadeOutHandler=f,a.HEX=h,a.Particle=u,a.ParticleSystem=o,a.RGBA=s,a.range=r,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
